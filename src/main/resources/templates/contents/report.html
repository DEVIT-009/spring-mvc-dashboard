<div th:fragment="report">
  <!-- Content Header -->
  <section class="content-header">
    <h1>
      Reports
      <small>System analytics & summaries</small>
    </h1>
    <ol class="breadcrumb">
      <li>
        <a href="#"><i class="fa fa-dashboard"></i> Dashboard</a>
      </li>
      <li class="active">Reports</li>
    </ol>
  </section>

  <!-- Main content -->
  <section class="content">
    <!-- Filter Row -->
    <div class="row">
      <div class="col-md-12">
        <div class="box box-default">
          <div class="box-header with-border">
            <h3 class="box-title">
              <i class="fa fa-filter"></i> Report Filters
            </h3>
          </div>
          <div class="box-body">
            <div class="row">
              <div class="col-md-4">
                <label>Date Range</label>
                <input
                  type="text"
                  class="form-control"
                  placeholder="Select date range"
                />
              </div>
              <div class="col-md-4">
                <label>Report Type</label>
                <select class="form-control">
                  <option>Sales</option>
                  <option>Users</option>
                  <option>Orders</option>
                  <option>Revenue</option>
                </select>
              </div>
              <div class="col-md-4" style="margin-top: 25px">
                <button class="btn btn-primary">
                  <i class="fa fa-search"></i> Generate
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Summary Boxes -->
    <div class="row">
      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-aqua">
          <div class="inner">
            <h3>12,500</h3>
            <p>Total Sales</p>
          </div>
          <div class="icon">
            <i class="fa fa-shopping-cart"></i>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-green">
          <div class="inner">
            <h3>$8,200</h3>
            <p>Total Revenue</p>
          </div>
          <div class="icon">
            <i class="fa fa-money"></i>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-yellow">
          <div class="inner">
            <h3>320</h3>
            <p>New Users</p>
          </div>
          <div class="icon">
            <i class="fa fa-users"></i>
          </div>
        </div>
      </div>

      <div class="col-lg-3 col-xs-6">
        <div class="small-box bg-red">
          <div class="inner">
            <h3>18</h3>
            <p>Refunds</p>
          </div>
          <div class="icon">
            <i class="fa fa-exclamation-triangle"></i>
          </div>
        </div>
      </div>
    </div>

    <!-- Charts -->
    <div class="row">
      <section class="col-lg-6">
        <div class="box box-success">
          <div class="box-header with-border">
            <h3 class="box-title">Bar Chart</h3>
            <div class="box-tools pull-right">
              <button class="btn btn-box-tool" data-widget="collapse">
                <i class="fa fa-minus"></i>
              </button>
              <button class="btn btn-box-tool" data-widget="remove">
                <i class="fa fa-times"></i>
              </button>
            </div>
          </div>
          <div class="box-body chart-responsive">
            <canvas id="report-bar-chart" width="400" height="300"></canvas>
          </div>
          <!-- /.box-body -->
        </div>
      </section>

      <section class="col-lg-6">
        <div class="box box-success">
          <div class="box-header with-border">
            <h3 class="box-title">
              <i class="fa fa-pie-chart"></i> Revenue Distribution
            </h3>
          </div>
          <div class="box-body">
            <canvas id="revenue-pie-chart" width="400" height="300"></canvas>
          </div>
        </div>
      </section>
    </div>

    <!-- Report Table -->
    <div class="row">
      <div class="col-md-12">
        <div class="box box-info">
          <div class="box-header with-border">
            <h3 class="box-title">
              <i class="fa fa-table"></i> Detailed Report
            </h3>
          </div>
          <div class="box-body table-responsive">
            <table class="table table-bordered table-striped">
              <thead>
                <tr>
                  <th>#</th>
                  <th>Date</th>
                  <th>Type</th>
                  <th>Amount</th>
                  <th>Status</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>2026-01-10</td>
                  <td>Sales</td>
                  <td>$1,200</td>
                  <td><span class="label label-success">Completed</span></td>
                </tr>
                <tr>
                  <td>2</td>
                  <td>2026-01-09</td>
                  <td>Refund</td>
                  <td>$120</td>
                  <td><span class="label label-danger">Returned</span></td>
                </tr>
                <tr>
                  <td>3</td>
                  <td>2026-01-08</td>
                  <td>Sales</td>
                  <td>$860</td>
                  <td><span class="label label-success">Completed</span></td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="box-footer clearfix">
            <button class="btn btn-default">
              <i class="fa fa-download"></i> Export CSV
            </button>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Chart.js Scripts for Report Page -->
  <script>
    $(window).on("load", function () {
      "use strict";
      // Wait for Chart.js to be available with retry
      function initCharts() {
        if (typeof Chart !== "undefined") {
          // Bar Chart (Report page)
          if ($("#report-bar-chart").length) {
            var reportBarCanvas = $("#report-bar-chart")
              .get(0)
              .getContext("2d");
            var reportBarChart = new Chart(reportBarCanvas);
            var reportBarData = {
              labels: ["Jan", "Feb", "Mar", "Apr", "May", "Jun"],
              datasets: [
                {
                  label: "Sales",
                  fillColor: "rgba(60,141,188,0.9)",
                  strokeColor: "rgba(60,141,188,0.8)",
                  pointColor: "#3b8bba",
                  pointStrokeColor: "rgba(60,141,188,1)",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(60,141,188,1)",
                  data: [28, 48, 40, 19, 86, 27],
                },
                {
                  label: "Revenue",
                  fillColor: "rgba(0,166,90,0.9)",
                  strokeColor: "rgba(0,166,90,0.8)",
                  pointColor: "#00a65a",
                  pointStrokeColor: "rgba(0,166,90,1)",
                  pointHighlightFill: "#fff",
                  pointHighlightStroke: "rgba(0,166,90,1)",
                  data: [65, 59, 80, 81, 56, 55],
                },
              ],
            };
            var reportBarOptions = {
              scaleBeginAtZero: true,
              scaleShowGridLines: true,
              scaleGridLineColor: "rgba(0,0,0,.05)",
              scaleGridLineWidth: 1,
              scaleShowHorizontalLines: true,
              scaleShowVerticalLines: true,
              barShowStroke: true,
              barStrokeWidth: 2,
              barValueSpacing: 5,
              barDatasetSpacing: 1,
              responsive: true,
              maintainAspectRatio: true,
            };
            reportBarChart.Bar(reportBarData, reportBarOptions);
          }

          // Revenue Pie Chart (Report page)
          if ($("#revenue-pie-chart").length) {
            var revenuePieCanvas = $("#revenue-pie-chart")
              .get(0)
              .getContext("2d");
            var revenuePieChart = new Chart(revenuePieCanvas);
            var revenuePieData = [
              {
                value: 700,
                color: "#f56954",
                highlight: "#f56954",
                label: "Product Sales",
              },
              {
                value: 500,
                color: "#00a65a",
                highlight: "#00a65a",
                label: "Services",
              },
              {
                value: 400,
                color: "#f39c12",
                highlight: "#f39c12",
                label: "Subscriptions",
              },
              {
                value: 300,
                color: "#00c0ef",
                highlight: "#00c0ef",
                label: "Licenses",
              },
              {
                value: 200,
                color: "#3c8dbc",
                highlight: "#3c8dbc",
                label: "Other",
              },
            ];
            var revenuePieOptions = {
              segmentShowStroke: true,
              segmentStrokeColor: "#fff",
              segmentStrokeWidth: 2,
              percentageInnerCutout: 50,
              animationSteps: 100,
              animationEasing: "easeOutBounce",
              animateRotate: true,
              animateScale: false,
              responsive: true,
              maintainAspectRatio: true,
            };
            revenuePieChart.Doughnut(revenuePieData, revenuePieOptions);
          }
        } else {
          // Retry after a short delay if Chart.js is not loaded
          setTimeout(initCharts, 100);
        }
      }
      initCharts();
    });
  </script>
</div>
